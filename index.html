<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Civil Engineering Hub</title>
    <style>
        :root {
            --primary-grad: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
            --bg: #f8fafc;
            --text: #1e293b;
        }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 0; color: var(--text); min-height: 100vh; position: relative; padding-bottom: 50px; }

        /* --- HEADER --- */
        .header {
            background: var(--primary-grad); padding: 15px 10px;
            position: sticky; top: 0; z-index: 100;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15); color: white;
        }
        .nav-btn {
            background: rgba(255,255,255,0.15); border: 1px solid rgba(255,255,255,0.2);
            color: white; font-size: 20px; cursor: pointer; width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%; transition: 0.2s; backdrop-filter: blur(4px);
        }
        .hidden-btn { visibility: hidden; pointer-events: none; } 
        .header-center { text-align: center; flex: 1; }
        .header-center h1 { margin: 0; font-size: 16px; font-weight: 800; text-transform: uppercase; }
        .header-center p { margin: 2px 0 0; font-size: 10px; opacity: 0.9; }
        .container { max-width: 800px; margin: 0 auto; padding: 15px; }

        /* --- GRIDS & CARDS --- */
        .grid-sub { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; }
        .grid-test { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; }

        .card {
            background: white; padding: 20px; border-radius: 15px; text-align: center; cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02); border-bottom: 5px solid #ddd; transition: all 0.2s;
        }
        .icon-box { width: 50px; height: 50px; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 24px; }
        .sub-title { font-weight: 700; font-size: 14px; color: #334155; display: block; }
        .sub-count { font-size: 11px; color: #94a3b8; margin-top: 5px; display: block; }

        /* --- TOPIC LIST --- */
        .topic-item { 
            background: white; padding: 15px; margin-bottom: 12px; border-radius: 12px; 
            display: flex; align-items: center; cursor: pointer;
            border-left: 5px solid #ccc; box-shadow: 0 2px 4px rgba(0,0,0,0.03);
        }
        .topic-num { 
            background: #f1f5f9; color: #475569; width: 30px; height: 30px; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            font-weight: 800; margin-right: 15px; font-size: 13px; flex-shrink: 0;
        }
        .topic-name { font-weight: 600; font-size: 14px; color: #334155; }

        /* --- TEST BUTTONS --- */
        .t-btn { 
            background: white; border: 1px solid #e2e8f0; padding: 12px 5px; border-radius: 10px; 
            text-align: center; text-decoration: none; color: #333; display: block; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.02); cursor: pointer;
        }
        .t-lbl { font-size: 10px; text-transform: uppercase; color: #94a3b8; display: block; font-weight: 600; }
        .t-val { font-size: 18px; font-weight: 800; }

        /* --- BOOKMARK GOLD BUTTON --- */
        .btn-gold {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white !important; border: 1px solid #b45309;
        }
        .btn-gold .t-lbl { color: rgba(255,255,255,0.9); }

        /* --- BOOKMARK VIEW STYLES (NEW) --- */
        .bm-controls { display: flex; justify-content: flex-end; margin-bottom: 15px; }
        .btn-print { background: #ea580c; color: white; padding: 8px 15px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; }
        
        .q-card { background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .q-text { font-weight: bold; margin-bottom: 10px; font-size: 16px; }
        .opt-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .opt { background: #f8fafc; padding: 8px; border: 1px solid #e2e8f0; border-radius: 5px; font-size: 14px; }
        .ans-box { margin-top: 10px; padding: 10px; background: #f0fdf4; border-left: 4px solid #16a34a; font-size: 14px; display: none; }
        .show-ans .ans-box { display: block; }

        /* Screen Management */
        .screen { display: none; }
        .active { display: block; }
        .footer-name { position: fixed; bottom: 10px; right: 15px; font-weight: 800; font-size: 14px; color: #1e293b; z-index: 99; }

        /* Themes */
        .theme-blue { border-bottom-color: #3b82f6; } .theme-blue .icon-box { background: #eff6ff; color: #3b82f6; }
        .theme-green { border-bottom-color: #10b981; } .theme-green .icon-box { background: #ecfdf5; color: #10b981; }
        .theme-orange { border-bottom-color: #f59e0b; } .theme-orange .icon-box { background: #fffbeb; color: #f59e0b; }
        .theme-red { border-bottom-color: #ef4444; } .theme-red .icon-box { background: #fef2f2; color: #ef4444; }
        .theme-purple { border-bottom-color: #8b5cf6; } .theme-purple .icon-box { background: #f5f3ff; color: #8b5cf6; }

        /* --- PRINT PDF SETTINGS --- */
        @media print {
            .header, .nav-btn, .footer-name, .bm-controls, .no-print { display: none !important; }
            body { background: white; padding: 0; }
            .container { max-width: 100%; padding: 0; }
            .q-card { box-shadow: none; border: 1px solid #ccc; page-break-inside: avoid; }
            .ans-box { display: block !important; }
        }
    </style>
</head>
<body>

    <div class="header">
        <button id="btn-back" class="nav-btn hidden-btn" onclick="goBack()">&#8592;</button>
        <div class="header-center">
            <h1 id="page-title">Civil Engg Hub</h1>
            <p id="page-subtitle">Select Subject</p>
        </div>
        <button id="btn-home" class="nav-btn" onclick="goHome()">&#8962;</button>
    </div>

    <div class="container">
        <div id="screen-sub" class="screen active"><div class="grid-sub" id="sub-list"></div></div>
        
        <div id="screen-top" class="screen"><div id="top-list"></div></div>
        
        <div id="screen-test" class="screen"><div class="grid-test" id="test-list"></div></div>
        
        <div id="screen-bookmark" class="screen">
            <div class="bm-controls">
                <button onclick="window.print()" class="btn-print">üñ®Ô∏è Print / Save PDF</button>
            </div>
            <div id="bm-list"></div>
        </div>
    </div>

    <div class="footer-name">Er.Nilambar Yadav</div>

    <script>
        // --- DATA ---
        const db = [
            { code: "irri", name: "Irrigation Engg.", icon: "üíß", theme: "theme-blue", topics: ["Introduction & Methods", "Soil Moisture Plant Relation", "Water Requirement of Crops", "Canal Irrigation System", "Design of Lined/Unlined Canals", "Water Logging & Reclamation", "River Training Works", "Diversion Head Works", "Canal Regulation Works", "Cross Drainage Works", "Dams & Reservoirs", "Spillways & Energy Dissipators"] },
            { code: "envi", name: "Environmental Engg.", icon: "üå≥", theme: "theme-green", topics: ["Water Demand & Population", "Quality Control of Water", "Water Treatment", "Disinfection & Softening", "Distribution System", "System of Sanitation", "Characteristics of Sewage", "Sewage Treatment", "Disposal of Sewage", "Solid Waste Management", "Air & Noise Pollution"] },
            { code: "stre", name: "Strength of Materials", icon: "üî®", theme: "theme-red", topics: ["Properties of Materials", "Simple Stress & Strain", "SFD & BMD", "Principal Stress & Strain", "Bending Stresses", "Shear Stresses", "Torsion of Shafts", "Slope & Deflection", "Columns & Struts", "Thin & Thick Cylinders", "Springs"] },
            { code: "soil", name: "Soil Mechanics", icon: "üèúÔ∏è", theme: "theme-orange", topics: ["Origin & Properties", "Soil Water Relationship", "Classification of Soil", "Permeability & Seepage", "Effective Stress", "Compaction of Soil", "Consolidation", "Shear Strength", "Earth Pressure", "Stability of Slopes", "Shallow Foundation", "Deep Foundation (Piles)", "Soil Exploration"] },
            { code: "rccd", name: "RCC Design", icon: "üèóÔ∏è", theme: "theme-purple", topics: ["Introduction (LSM & WSM)", "Shear, Torsion & Bond", "Analysis of Beams", "Design of Slabs", "Design of Columns", "Design of Footings", "Retaining Walls", "Prestressed Concrete", "Water Tanks"] },
            { code: "flui", name: "Fluid Mechanics", icon: "üåä", theme: "theme-blue", topics: ["Properties of Fluid", "Pressure & Measurement", "Hydrostatic Forces", "Buoyancy", "Fluid Kinematics", "Fluid Dynamics", "Flow Through Pipes", "Laminar & Turbulent Flow", "Boundary Layer", "Open Channel Flow", "Hydraulic Machines"] },
            { code: "surv", name: "Surveying", icon: "üì∑", theme: "theme-green", topics: ["Introduction & Scale", "Linear Measurement", "Compass Surveying", "Theodolite Surveying", "Traversing", "Leveling & Contouring", "Plane Table Surveying", "Tacheometry", "Curves", "Photogrammetry"] },
            { code: "high", name: "Highway Engg.", icon: "üõ£Ô∏è", theme: "theme-orange", topics: ["Highway Planning", "Geometric Design", "Traffic Engineering", "Highway Materials", "Design of Pavements", "Highway Construction", "Highway Maintenance"] },
            { code: "stee", name: "Steel Structure", icon: "üî©", theme: "theme-red", topics: ["Connections (Riveted/Bolted)", "Welded Connections", "Tension Members", "Compression Members", "Column Bases", "Beams & Girders", "Roof Trusses", "Plastic Analysis"] },
            { code: "conc", name: "Concrete Engg.", icon: "üíß", theme: "theme-blue", topics: ["Introduction", "Ingredients of concrete", "Water cement ratio", "workability of concrete", "concrete mix", "form work", "concreting operations", "physical properties of concrete", "admixture and their uses", "quality control of concrete", "concrete in adverse condition", "joints in concrete work","maintenance of concrete","special type of concrete","repair and maintenaince of concrete"] },
            { code: "buil", name: "Building Material", icon: "üß±", theme: "theme-purple", topics: ["Rock", "Stone", "brick", "Tiles", "Building lime", "Cement", "Timber and wood based product", "Paint","Varnishes","Ferrous and non ferrous metal","Glass and glass product","Plastic","Heat insulating material","Sound insulating material","Water proofing material"] },
            { code: "cons", name: "Construction technology Engg.", icon: "üíß", theme: "theme-blue", topics: ["pert and network analysis bar chart", "cpm", "crashing of network&resources allocation supporting", "engineering economy", "engineering equipment"] },
            { code: "rail", name: "Railway Engg.", icon: "üöÇ", theme: "theme-blue", topics: ["Introduction & Rails", "Sleepers & Ballast", "Rail Fastenings", "Geometric Design of Track", "Points & Crossings", "Signalling"] },
            { code: "cpm", name: "CPM & PERT", icon: "üìã", theme: "theme-orange", topics: ["Project Management", "PERT Analysis", "CPM Analysis", "Cost Analysis", "Resource Allocation", "Construction Equipments", "Tenders"] }
        ];

        let currSub = null;
        let currTopicIdx = 0;

        // --- RENDER SUBJECTS ---
        const subList = document.getElementById('sub-list');
        db.forEach(sub => {
            subList.innerHTML += `
            <div class="card ${sub.theme}" onclick="openTopics('${sub.code}')">
                <div class="icon-box">${sub.icon}</div>
                <span class="sub-title">${sub.name}</span>
                <span class="sub-count">${sub.topics.length} Topics</span>
            </div>`;
        });

        // --- NAVIGATION LOGIC ---
        function switchScreen(id, title, subtitle) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('page-title').innerText = title;
            document.getElementById('page-subtitle').innerText = subtitle;

            const btnBack = document.getElementById('btn-back');
            if (id === 'screen-sub') btnBack.classList.add('hidden-btn');
            else btnBack.classList.remove('hidden-btn');
        }

        function openTopics(code) {
            currSub = db.find(s => s.code === code);
            const list = document.getElementById('top-list');
            list.innerHTML = '';
            
            let color = "#3b82f6";
            if(currSub.theme.includes("green")) color="#10b981";
            if(currSub.theme.includes("orange")) color="#f59e0b";
            if(currSub.theme.includes("red")) color="#ef4444";
            if(currSub.theme.includes("purple")) color="#8b5cf6";

            currSub.topics.forEach((t, i) => {
                list.innerHTML += `
                <div class="topic-item" onclick="openTests(${i})" style="border-left-color:${color}">
                    <div class="topic-num" style="color:${color}">${i+1}</div>
                    <div class="topic-name">${t}</div>
                </div>`;
            });
            switchScreen('screen-top', currSub.name, "Select Topic");
        }

        function openTests(index) {
            currTopicIdx = index;
            const list = document.getElementById('test-list');
            list.innerHTML = '';

            // --- CHECK FOR SAVED BOOKMARKS ---
            const allBookmarks = JSON.parse(localStorage.getItem('civilHubBookmarks')) || {};
            const subData = allBookmarks[currSub.code]; 
            
            // If bookmarks exist for this topic, create Gold Button
            if (subData && subData[index] && subData[index].length > 0) {
                const count = subData[index].length;
                const b = document.createElement('div');
                b.className = 't-btn btn-gold';
                b.onclick = function() { openBookmarkView(); }; // Opens functionality inside this file
                b.innerHTML = `<span class="t-lbl">SAVED</span><span class="t-val">‚òÖ BOOKMARKS (${count})</span>`;
                list.appendChild(b);
            }

            // Normal Tests
            for(let i=1; i<=50; i++) {
                const a = document.createElement('a');
                a.className = 't-btn';
                a.innerHTML = `<span class="t-lbl">TEST</span><span class="t-val">${i}</span>`;
                a.href = `${currSub.code}.${index+1}.${i}.html`;
                list.appendChild(a);
            }
            switchScreen('screen-test', currSub.topics[index], "Select Test");
        }

        // --- NEW: OPEN BOOKMARK SCREEN ---
        function openBookmarkView() {
            const list = document.getElementById('bm-list');
            list.innerHTML = '';

            const allBookmarks = JSON.parse(localStorage.getItem('civilHubBookmarks')) || {};
            const questions = allBookmarks[currSub.code][currTopicIdx];

            if(questions && questions.length > 0) {
                questions.forEach((q, i) => {
                    let html = `
                    <div class="q-card" onclick="this.classList.toggle('show-ans')">
                        <div class="q-text">Q${i+1}. ${q.q}</div>
                        <div class="opt-grid">
                            <div class="opt">(A) ${q.a}</div>
                            <div class="opt">(B) ${q.b}</div>
                            <div class="opt">(C) ${q.c}</div>
                            <div class="opt">(D) ${q.d}</div>
                        </div>
                        <div class="ans-box">
                            <b>Answer: (${q.ans.toUpperCase()})</b><br>
                            <span style="color:#666;">${q.sol || ""}</span>
                            <div class="no-print" style="margin-top:10px; text-align:right;">
                                <button onclick="deleteBookmark(${i})" style="color:red; background:none; border:none; cursor:pointer;">üóëÔ∏è Delete Question</button>
                            </div>
                        </div>
                        <div class="no-print" style="text-align:center; font-size:10px; color:#999; margin-top:5px;">(Click card to see answer)</div>
                    </div>`;
                    list.innerHTML += html;
                });
            } else {
                list.innerHTML = "<p>No bookmarks found.</p>";
            }

            switchScreen('screen-bookmark', "Saved Questions", currSub.topics[currTopicIdx]);
        }

        function deleteBookmark(qIndex) {
            event.stopPropagation(); // Stop card from toggling answer
            if(confirm("Remove this question?")) {
                let db = JSON.parse(localStorage.getItem('civilHubBookmarks'));
                db[currSub.code][currTopicIdx].splice(qIndex, 1); // Remove
                
                // If empty, delete the key
                if(db[currSub.code][currTopicIdx].length === 0) {
                    delete db[currSub.code][currTopicIdx];
                }
                
                localStorage.setItem('civilHubBookmarks', JSON.stringify(db));
                
                // Re-render
                if(db[currSub.code][currTopicIdx]) {
                    openBookmarkView(); 
                } else {
                    goBack(); // If no questions left, go back to test list
                }
            }
        }

        function goBack() {
            if(document.getElementById('screen-bookmark').classList.contains('active')) openTests(currTopicIdx);
            else if(document.getElementById('screen-test').classList.contains('active')) openTopics(currSub.code);
            else if(document.getElementById('screen-top').classList.contains('active')) goHome();
        }

        function goHome() {
            currSub = null;
            switchScreen('screen-sub', "Civil Engg Hub", "Select Subject");
        }
    </script>
</body>
</html>
